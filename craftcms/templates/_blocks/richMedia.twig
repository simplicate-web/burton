{## Rich Media Block
    ---------------------------------------------------------------------------- ##
    this template is typically included from `_blocks/_base.twig` which pre-sets
    a handful of variables and passes them into this template via twig context.
 ## ---------------------------------------------------------------------------- ##}
{% set thisBlock = {
    content     : null,
    settings    : null,
    blockLayout : '_layouts/micro/blockLayoutLeftRightEven',
}|map( (item,key) => _context[key] ??? settings[key] ??? item ) %}

{% embed thisBlock.blockLayout %}
    {## primary text content is already added to this block layout via the `cell1Body`
        variable declared in `_blocks/_base`. Uncomment {% block %} below to customize

        {% block cell1Body %}
          {{ thisBlock.content.text }}
        {% endblock %}
    ##}

    {% block cell2Body %}
        {% set source   = thisBlock.content.source ??? null %}
        {% set urls     = thisBlock.content.urls   ??? null %}
        {% set assets   = thisBlock.content.assets.all() ??? null %}
        {% set template = thisBlock.settings.mediaComponent ??? thisBlock.settings.mediaCard ??? '_cards/media/_router' %}

        {% set urls   = ( source == 'external' or ( urls and not assets ) ) ? urls   : null %}
        {% set assets = ( source == 'local'    or ( assets and not urls ) ) ? assets : null %}

        {% import "_macros/embed" as embedExternal %}
        {% for exMedia in urls %}
            {{ embedExternal.iframe( exMedia.url, thisBlock.settings, blockID, loop ) }}
        {% endfor %}

        {{ include( template, {
            urls    : urls,
            assets  : assets,
            source  : source,
            settings: thisBlock.settings
        }, withContext = false ) }}
    {% endblock %}
{% endembed %}