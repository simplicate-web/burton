{% set image      = images.one() ??? image ??? null %}
{% set caption    = caption ??? null %}
{% set caption    = caption ? attribute(image, caption) ??? caption %}

{% set settings   = settings ??? null %}
{% set blockID    = settings.blockID ?? null %}

{% set uuid = create('craft\\helpers\\StringHelper').UUID() %}

{% embed '_components/images/basic' with {
    image: image,
    class: "object-cover object-center h-full w-full relative z-10",
    transform: 'widescreen'
} %}
    {% block figure %}
        <figure
            id="p{{uuid}}"
            class="absolute top-0 left-0 right-0 bottom-0 before:absolute before:content-[''] before:block before:top-0 before:left-0 before:right-0 before:bottom-0 before:bg-slate-700/70 before:z-20"
        >
    {% endblock %}

    {% block figcaption %}
        {% import "_macros/imgtags" as imgtags %}
        {{ caption ? imgtags.figCaption( caption, "absolute bottom-8 left-8 right-8 bg-black/60 mx-auto max-w-xl text-white text-sm p-4 text-center" ) }}
    {% endblock %}
{% endembed %}

{% js %}
    {% if blockID %}
        window.waitForGlobal("app.gsap", function() {
            app.gsap.fromTo('#p{{uuid}} img', {
                y: '-25%',
                x: '-10%',
                scale: 1.7
            }, {
                y: '50%',
                x: '0%',
                scale: 1.1,
                ease: "none",
                scrollTrigger: {
                    trigger: '#cScene{{blockID}}',
                    start: () => "top bottom",
                    end: "bottom top",
                    scrub: true,
                    invalidateOnRefresh: true // to make it responsive
                }
            });
        });
    {% endif %}
{% endjs %}