{% set _base = {
    image         : images.one() ??? image ??? null,
    imageClass    : "object-cover object-center h-full w-full relative z-10",
    imageTransform: "widescreen",
    imageCaptionClass: "absolute bottom-8 left-8 right-8 bg-black/60 mx-auto max-w-xl text-white text-sm p-4 text-center",
    altText       : alt ??? altText ??? image.alt ??? image.title ??? null,
    sizes         : null,
    uuid          : create('craft\\helpers\\StringHelper').UUID()
} %}

{# -- merge `_base` into variables passed into the template  -- #}
{% set settings = ( settings is defined and settings is iterable ) ? _base|merge(settings) : _base %}

{% embed '_components/images/_base' %}
    {% block figure %}
        <figure
            id="parallax-{{settings.uuid}}"
            class="absolute top-0 left-0 right-0 bottom-0 before:absolute before:content-[''] before:block before:top-0 before:left-0 before:right-0 before:bottom-0 before:bg-slate-700/70 before:z-20"
        >
    {% endblock %}
{% endembed %}

{% js %}
    {% if settings.blockID and settings.uuid %}
        window.waitForGlobal("app.gsap", function() {
            app.gsap.fromTo('#parallax-{{settings.uuid}} img', {
                y: '-25%',
                x: '-10%',
                scale: 1.7
            }, {
                y: '50%',
                x: '0%',
                scale: 1.1,
                ease: "none",
                scrollTrigger: {
                    trigger: '#cScene{{settings.blockID}}',
                    start: () => "top bottom",
                    end: "bottom top",
                    scrub: true,
                    invalidateOnRefresh: true // to make it responsive
                }
            });
        });
    {% endif %}
{% endjs %}