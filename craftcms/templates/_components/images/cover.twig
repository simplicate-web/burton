{% set _base = {
    image            : images.one() ??? image ??? null,
    imageClass       : "object-cover object-center h-full w-full relative z-20",
    imageTransform   : "square",
    imageCoverFull   : "absolute top-0 left-0 right-0 bottom-0",
    imageCoverLeft   : "absolute top-0 left-0 w-[50vw] bottom-0",
    imageCoverRight  : "absolute top-0 right-0 w-[50vw] bottom-0",
    imageCaptionClass: "absolute bottom-8 left-8 right-8 bg-black/60 mx-auto max-w-xl text-white text-sm p-4 z-20 text-center"
} %}

{# -- merge `_base` into variables passed into the template  -- #}
{% set settings = ( settings is defined and settings is iterable ) ? settings|merge(_base) : _base %}

{% set caption    = settings.imageCaption ? attribute(settings.image, settings.imageCaption) ??? settings.imageCaption : null %}
{% set coverClass = settings.imageCoverFull %}
{% set coverClass = settings.layout == 'textRight' ? settings.imageCoverLeft  : coverClass %}
{% set coverClass = settings.layout == 'textLeft'  ? settings.imageCoverRight : coverClass %}

<template x-teleport="#cScene{{settings.blockID}}">
    {% embed '_components/images/_base' %}
        {% block figure %}
            <figure class="{{coverClass}}">
        {% endblock %}

        {% block figcaption %}
            {% import "_macros/imgtags" as imgtags %}
            {{ caption ? imgtags.figCaption( caption, settings.imageCaptionClass ) }}
        {% endblock %}
    {% endembed %}
</template>