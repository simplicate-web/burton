{% set handle = 'primary' %}

{% set title  = title ??? craft.navigation.getNavByHandle( handle ).name ??? null %}
{% set nodes  = craft.navigation.nodes().handle( handle ).level(1) %}

{% embed ["_site/menu.list", "_core/menu.list"] with {
    title : title,
    handle: handle,
    items : nodes.all() ??? null,
} %}
    {% block item %}
        {{ node.hasDescendants ??? null
            ? block('dropdownMenu') : parent() }}
    {% endblock %}

    {% block dropdownMenu %}
        {% embed ["_site/menu.dropdown", "_core/menu.dropdown"] with { dropdown: node } %}
        {% endembed %}
    {% endblock %}

    {% block lastItem %}
        {{ block( 'openItem' ) }}

        {{ tag( 'a', {
            href : siteUrl('/search'),
            class: block('itemClass'),
            html : svg( '@webroot/static/svg/search.svg' )
        }) }}

        {{ block( 'closeItem' ) }}
    {% endblock %}
{% endembed %}