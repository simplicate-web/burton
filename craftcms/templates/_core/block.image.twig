{## Image Block Base
{-------------------------------------------------------------------------------------##
    -> http://localhost:8000/sitehub/blocks/image
{-------------------------------------------------------------------------------------##}
{% set settings    = settings ??? block.settings ??? {}  %}
{% set microlayout = settings.microlayout ??? 'zone1Top' %}
{% set imagelayer  = settings.imagelayer  ??? 'default'  %}
{% set imagesource = block.source.value   ??? 'images'   %}
{% set images      = [] %}

{% if imagesource == 'images' %}
    {% set images = block.images.all() ??? block.images ??? [] %}
{% endif %}

{% if imagesource == 'collect' %}
    {% set params = {
        limit: block.source.settings.limit ??? -1,
        field: 'images'
    } %}

    {% set images = CollectionBase( block.collections.ids(), params ) %}
{% endif %}

{% embed [ "_site/block", "_core/block" ] with {
    block: block,
    images: images,
    settings: settings,
    imagelayer: imagelayer,
    microlayout: microlayout,
} %}
    {## Image Block Content ##}
    {% block content %}
        {% import "_assemble" as assemble %}
        {{ assemble.microlayout( microlayout, {
            zone1    : block('block__text'),
            zone2    : block('block__images'),
            header   : block('block__header'),
            footer   : block('block__footer'),
        }, settings ) }}
    {% endblock %}


    {## Zone 2 Content ##}
    {% block block__images %}
        {% import "_assemble" as assemble %}
        {{ assemble.images( images, imagelayer, settings ) }}
    {% endblock %}
{% endembed %}