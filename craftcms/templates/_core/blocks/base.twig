{## Block Base Template
 ------------------------------------------------------------------------------------ ##
    Defines the the outermost (non-content) html layer for all base content blocks.

        // (optional) divider above block
        <div data-theme="themeName">
            // (optional) interspace above content
            <div class="container">
                <section data-block="blockType">
                    // block content
                <section>
            </div>
            // (optional) interspace below content
        </div>
        // (optional) divider below block

 ------------------------------------------------------------------------------------ ##

 ## Load named blocks from other templates to be called like functions. These named
    blocks rely on the current '_context' for data and do not accept arguments.

    Child templates can override named blocks by creating a {% block %} with the
    same name or by reassign the name to another template with {% use %}.

    Learn more: https://twig.symfony.com/doc/3.x/tags/use.html

 ------------------------------------------------------------------------------------ ##}
{% import "_site/layout/assemble" as layout %}

{% use "_core/blocks/common" with block__text__core    as block__text,
                                  block__header__core  as block__header,
                                  block__footer__core  as block__footer  %}

{## Block HTML Skeleton
 ------------------------------------------------------------------------------------ ##
    The output of this {% block %} becomes the rendered html for each content block.
 ------------------------------------------------------------------------------------ ##}
{% block block %}


    {## Divider Above Block
     -------------------------------------------------------------------------------- ##
        Content to insert before opening the outer theme. Typically used for dividers.
     -------------------------------------------------------------------------------- ##}
    {{ layout.spacer( block.settings.betweenAbove ??? false ) }}



    {## Outer Theme Wrapper
     -------------------------------------------------------------------------------- ##
        It can be useful for a child template to override this wrapper block and
        combine it with the Twig `parent()` function to render the layout to a template
        variable as html.

        The rendered html can then be manipulated with something like Retcon before
        sending it to the browser. Read more: https://github.com/mmikkel/Retcon-Craft

        i.e.
        {% block theme %}
            {{ parent()
                | retconAttr( 'div', { class: 'whatever' } )
                | retconRemove( 'h1' ) }}
        {% endblock %}
     -------------------------------------------------------------------------------- ##}
    {% block theme %}


        {## Open Theme Tag
         ---------------------------------------------------------------------------- ##
            One wrapper theme tag (typically a <div>) will get wrapped around as many
            blocks in a row that share the same theme. If every block uses a different
            theme, each block will open and close an outer theme tag.

            If this block theme matches the previous block theme, we can inherit the
            already open theme tag instead of starting a new one. This also assumes
            that the theme was not closed at the end of the previous block.
         ---------------------------------------------------------------------------- ##}
        {% if block.prev.theme|default() != block.settings.theme %}
            {{ block( "theme__open" ) | raw }}
        {% endif %}


        {## Outer Block Wrapper
         ---------------------------------------------------------------------------- ##
            Basically the same as the Outer Theme Wrapper, just a little less .. outer
         ---------------------------------------------------------------------------- ##}
        {% block outer %}


            {## Interspace Above Content
            ------------------------------------------------------------------------- ##
                Essentially top padding between the theme edge and the block content
            ------------------------------------------------------------------------- ##}
            {{ layout.spacer( block.settings.interspaceAbove ?? true ) }}


            {## Open <section> + .container
            ------------------------------------------------------------------------- ##}
            {{ block( "block__open" ) }}


            {## Block Content
            ------------------------------------------------------------------------- ##
                Templates extending this base are responsible for populating content.
            ------------------------------------------------------------------------- ##}
            {% block content "" %}


            {## Close <section> + .container
            ------------------------------------------------------------------------- ##}
            {{ block( "block__close" ) }}


            {## Interspace Below Content
            ------------------------------------------------------------------------- ##
                Essentially bottom padding between block content and the theme edge

                To avoid double gaps, we typically exclude the bottom interspace element
                in cases where the next block has the same theme as the current one.
            ------------------------------------------------------------------------- ##}
            {% if block.next.theme|default() != block.settings.theme %}
                {{ layout.spacer( block.settings.interspaceBelow ?? true ) }}
            {% endif %}


        {% endblock outer %}


        {## Close Theme Tag
        ----------------------------------------------------------------------------- ##
            If the theme for this this block matches the theme for the next block we
            can leave the outer theme open instead of closing it and starting a new one,
            essentially following the same logic as the above "Interspace Below" element.
        ----------------------------------------------------------------------------- ##}
        {% if block.next.theme|default() != block.settings.theme %}
            {{ block( "theme__close" ) }}
        {% endif %}

    {% endblock theme %}


    {## Divider Below Block
     -------------------------------------------------------------------------------- ##
        Content to insert after closing the outer theme. Typically used for dividers.
     -------------------------------------------------------------------------------- ##}
    {{ layout.spacer( block.settings.betweenBelow ??? false ) }}

{% endblock %}