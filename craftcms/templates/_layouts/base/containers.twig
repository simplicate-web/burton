{## Container Sizes
 ------------------------------------------------------------------------------------ ##

    It'd be nice if we only ever had a site that used a single container size, but
    it seems like there's always a need for something a little different.

    These can be used from within templates any time a container is needed through
    `macros/layouts`.

    They are also frequently used within block configuration files as modifiers for
    *layout* or *interspace* options to make the content area wider or narrower.

 ------------------------------------------------------------------------------------ ##

    - http://localhost:8000/sitebook/layouts/containers

 ------------------------------------------------------------------------------------ ##

 !! This macro outputs as JSON so that it can be read by the macro template or any
    other place it might be useful (like Sitebook reference pages).

 ------------------------------------------------------------------------------------ ##}
{% macro definitions() %}{{ {

    _:'## defaults are used for any attributes left off an option definition',
    defaults: {
        tag: 'div',
        base: '@container',
        padding: ''
    },

    _:'## named container sizes',
    options: {
        container: {
            container: 'container'
        },

        none: { tag: false },

        wideContainer: {
            container: '2xl:container',
            padding: 'px-8 md:max-2xl:px-4'
        },

        wideColumn: {
            container: 'w-full',
            padding: 'px-4 md:max-2xl:px-4',
        },

        narrow: {
            container: 'max-w-5xl mx-auto container',
            padding: 'md:max-2xl:px-4'
        },

        tablet: {
            container: 'max-w-3xl mx-auto container',
            padding: 'md:max-2xl:px-4'
        },

        sidebar: {
            container: 'mx-auto max-w-sm',
            padding: 'px-6 xl:px-10'
        }
    }
} | json_encode() | raw }}{% endmacro %}


{## wrap a grid around a string of html ##}
{% macro wrap( html, name, extraClasses = null ) %}

    {% set json = _self.definitions() | json_decode %}
    {% set defs = json['defaults'] %}
    {% set opts = json['options']  %}

    {% set name = ( opts[name] ??? null ) ? name : opts | keys | first %}
    {% set attr = opts[name] ??? opts|first %}

    {% if ( attr.tag is defined ) and not attr.tag %}
        {## don't do nuthin' ##}
    {% else %}
        {{ tag( attr.tag ?? defs.tag ?? 'div', {
            html : html,
            class: [
                attr.base      ??? defs.base      ??? null,
                attr.container ??? defs.container ??? null,
                attr.padding   ??? defs.padding   ??? null,
                extraClasses
            ]
        } )}}
    {% endif %}
{% endmacro %}


{## just get the class of for a named container without wrapping it around anything ##}
{% macro class( name ) %}{% apply spaceless %}
    {% set attr = _self.wrap( "empty", name ) | parseAttr %}
    {{ attr ??? null and attr.class ??? null
        ? attr.class | join( ' ' )
        : "" }}
{% endapply %}{% endmacro %}