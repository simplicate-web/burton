{% extends "sitehub/_core/base" %}

{% html %}
    {## we need to include these here because they don't get loaded via the sprig/htmx
        based previewer, but they do load normally. moving them into app.js would also
        fix the issue, but this is a quick fix for demo purposes.
     -------------------------------------------------------------------------------- ##}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
{% endhtml %}

{% set blockType = type ??? null %}

{% set allowedBlocks = {
    text: {
        layout    : "_blocks/config/layout.text.header.json",
        variant   : "_blocks/config/variant.text.json",
        theme     : "_blocks/config/theme.header.json",
        interspace: "_blocks/config/interspace.header.json",
        content   : [
            "sitehub/blocks/_content/text.simple"
        ],
    },
    textDouble: {
        layout    : "_blocks/config/layout.textDouble.header.json",
        variant   : "_blocks/config/variant.textDouble.json",
        theme     : "_blocks/config/theme.header.json",
        interspace: "_blocks/config/interspace.header.json",
        content   : [
            "sitehub/blocks/_content/textDouble.simple"
        ],
    },
    image: {
        layout    : "_blocks/config/layout.image.header.json",
        variant   : "_blocks/config/variant.image.json",
        theme     : "_blocks/config/theme.header.json",
        interspace: "_blocks/config/interspace.header.json",
        content   : [
            "sitehub/blocks/_content/image.single",
            "sitehub/blocks/_content/image.single.tallimage",
            "sitehub/blocks/_content/image.single.longtext",
            "sitehub/blocks/_content/image.three",
            "sitehub/blocks/_content/image.gallery"
        ],
    },
    collection: {
        layout    : "_blocks/config/layout.collection.header.json",
        variant   : "_blocks/config/variant.collection.json",
        theme     : "_blocks/config/theme.header.json",
        interspace: "_blocks/config/interspace.header.json",
        content   : [
            "sitehub/blocks/_content/collection.simple"
        ],
    },
    media: {
        layout    : "_blocks/config/layout.media.header.json",
        variant   : "_blocks/config/variant.media.json",
        theme     : "_blocks/config/theme.header.json",
        interspace: "_blocks/config/interspace.header.json",
        content   : [
            "sitehub/blocks/_content/media.one.youtube",
            "sitehub/blocks/_content/media.four.youtube",
            "sitehub/blocks/_content/media.four.youtube.centered",
        ],
    }
} %}

{% set config = allowedBlocks[blockType]|default() %}

{% block page_main_content %}
    {% if config %}
        {{ sprig( 'sitehub/blocks/_previewer.sprig', {
            type     : blockType,
            config   : config,
            builder  : 'header',
            container: 'fluidContainer'
        } ) }}
    {% else %}
        <div data-theme="standard">
            <div class="container @container py-28 text-center">
                <h1>Header Blocks</h1>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 my-20">
                    {% for blockType, config in allowedBlocks %}
                        <div class="shadow rounded-lg p-8 relative bg-theme-backgroundOff @container">
                            <h2 class="capitalize">{{ blockType | kebab | replace({ '-': ' ' }) }}</h2>
                            <p class="html">{{ config.content|length }} content samples</p>
                            <p class="html"><a href="{{ url( "sitehub/blocks/header/#{blockType}"  ) }}" class="clickCover">Preview</a></p>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>


    {% endif %}

{% endblock page_main_content %}