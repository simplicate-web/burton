{## Article Card Factory
{-------------------------------------------------------------------------------------##

{## Using a Card Factory
{-------------------------------------------------------------------------------------##

{-------------------------------------------------------------------------------------##}
{%- set card     = card     ??? null -%}
{%- set cardpath = path     ??? card.path ??? ["_site/card","_core/card"] -%}
{%- set settings = settings is not null and settings is iterable ? settings : {} -%}

{## Add our defaults to `settings` in case they don't exist and/or we need them later ##}
{%- set settings = settings | merge({

}) -%}


{## Create the Card
{-------------------------------------------------------------------------------------##}
{%- if card -%}

    {## Inject a "Type Tag" inside the bottom right of the first <figure> tag that
        exists in the `card__images` block of any Article Card
    {---------------------------------------------------------------------------------##}
    {% set typetag = tag( 'div', {
        class: "absolute right-0 bottom-0 py-0.5 px-3 text-sm uppercase bg-canvas-light text-headline",
        text : card.type
    } ) %}


    {%- embed cardpath with {
        card    : card,
        typetag : typetag,
        settings: settings,
    } %}
        {% block card__images parent() | retconInject( 'figure', typetag ) %}
    {% endembed %}

{%- endif -%}