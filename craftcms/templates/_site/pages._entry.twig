{## Page & Landing Page Entry Router
 ------------------------------------------------------------------------------------ ##}
{% set template  = null %}
{% set entrytype = entry.type.handle|default(null) %}

{% if entrytype == 'redirect' and entry.redirect.url ??? null %}
    {% redirect entry.redirect.url %}
{% endif %}

{% if entrytype == 'standard' %}
    {% set template = "_site/layout" %}
{% endif %}

{% if entrytype == 'sidebar' %}
    {% set template = "_site/layout.sidebar" %}
{% endif %}

{% if entrytype == 'landingPages' %}
    {% set template = "_site/layout" %}

    {% if entry.sidebarBuilder.one() ??? null %}
        {% set template = "_site/layout.sidebar" %}
    {% endif %}
{% endif %}

{% if entrytype and template %}
    {{ include( template ) }}
{% else %}
    {% header "HTTP/1.0 404 Not Found" %}
{% endif %}


{## Generate the URI for page entries
 ------------------------------------------------------------------------------------ ##
    Often easier than trying to cram a bunch of conditional twig logic into the tiny
    space provided by the URI Format field in the control panel.

    However, you do need to trigger a manual resave of all entries if you change
    the URI sturcture in the below macro for existing records.
 ------------------------------------------------------------------------------------ ##}
{% macro uri( entry ) %}{% apply spaceless %}
    {% set entrytype = entry.type.handle ??? null %}
    {% set parenturi = entry.parent.uri  ??? null %}
    {% set prefixdir = entry.type.handle == 'landingPages' ? 'go' : null %}
    {{ [prefixdir, parenturi, entry.slug] | filter | join('/') }}
{% endapply %}{% endmacro %}