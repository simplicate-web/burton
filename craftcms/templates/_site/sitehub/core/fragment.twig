{## Sitehub is the built in component & layout documentation
   system for content editors. It can be accessed at:

    -> $CRAFT_WEB_URL/sitehub/

   Access is restricted to users with the permission:

    -> allowSitehub

   This template serves two purposes:

   1) helps redirect requests out of the pages structure
      and into the secondary /sitehub/ structure without
      having to do any weird nesting

   2) acts as a preview template for modular content without
      a public URL using /sitehub/?modular={{entry.id}}
#}
{% requirePermission 'allowSitehub' %}

{% set fragmentID = craft.app.request.getQueryParam('contentFragment') ??? craft.app.request.getQueryParam('sidebarFragment') ??? null %}
{% set entry      = fragmentID ? craft.entries().section('modular').id(fragmentID).one() ??? null  %}
{% set entryType  = entry.type.handle ??? null %}
{% set sidebar    = entry.sidebarBuilder.one() ??? null %}
{% set template   =  %}
{% extends sidebar ? "_layout/base.sidebar" : "_site/layout/layout.base" %}

{% if not entry %}
    {% redirect "/sitehub/" %}
{% endif %}