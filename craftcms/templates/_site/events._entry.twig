{## Entry Template for Events (Verbb plugin)
{---------------------------------------------------------------------------------------}
    Admin ➜ http://localhost:8000/cms/events/event-types
{-------------------------------------------------------------------------------------##}
{% set template = null %}
{% set handle   = event.type.handle ?? null %}


{## [Type] Conference ➜ http://localhost:8000/cms/events/event-types/1
{-------------------------------------------------------------------------------------##}
{% if 'conference' == handle %}
    {% set template = "_site/template.fullpage" %}
{% endif %}


{## [Type] Workshop ➜ http://localhost:8000/cms/events/event-types/2
{-------------------------------------------------------------------------------------##}
{% if 'workshop' == handle %}
    {% set template = "_site/template.fullpage" %}
{% endif %}


{## [Type] Live Stream ➜ http://localhost:8000/cms/events/event-types/3
{-------------------------------------------------------------------------------------##}
{% if 'livestream' == handle %}
    {% set template = "_site/template.fullpage" %}
{% endif %}


{## Render Template
{---------------------------------------------------------------------------------------}
    We use `extends` (vs `include`) to allow overriding template {% blocks %} in *this*
    template, rather than forcing separate files for each type, even for minimal changes.
  ➜ https://twig.symfony.com/doc/3.x/tags/extends.html
{-------------------------------------------------------------------------------------##}
{% extends template ? template : template_from_string('{% block base "" %}') %}


{## [Base] 404 Not Found ➜ craftcms/templates/_site/error.twig
{-------------------------------------------------------------------------------------##}
{% block base %}{% header "HTTP/1.0 404 Not Found" %}{% endblock %}



{#######################################################################################}
{##                                   Custom Macros                                   ##}
{#######################################################################################}


{## [Macro] Event URI Builder
{---------------------------------------------------------------------------------------}
    Better than a long-ass Twig-oneliner stuffed into the `URI Format` CP field:
  ➜ {% from '_site/events._entry' import uri %}{{ uri( object ) }}

 ## Output Examples
  └ leadership-series/toronto-2024
  └ leadership-women/calgary-2025
  └ workshops/session-name/2024-07-05
  └ livestreams/session-name/2025-01-30

 ## IMPORTANT ― Resave existing records (via console) anytime this macro changes:
  ➜ make craft "resave/events-events"
{-------------------------------------------------------------------------------------##}
{% macro uri( object ) %}{% apply spaceless %}
    {% set parts  = [] %}
    {% set handle = object.type.handle %}

    {% if 'conference' == handle %}
        {% set city   = object.city.one().slug ??? null %}
        {% set brand  = object.brand.one().slug ??? null %}
        {% set year   = object.startDate|date('Y') ??? null %}

        {% set parts = [ brand, "#{city}-#{year}" ] %}
    {% endif %}

    {% if not parts %}
        {% set parts = [ handle | pluralize | slugify, object.slug ] %}
    {% endif %}

    {{ parts | filter | join('/') }}
{% endapply %}{% endmacro %}



{#######################################################################################}
{##                                Template Overrides                                 ##}
{#######################################################################################}