{## [Topic] Entry Type Base
 ------------------------------------------------------------------------------------ ##}
{% extends "_layout/base" %}

{## double check that we're a topic and not a content feed or private tag ##}
{% if ( entry.type.handle ??? null ) != 'topic' %}
    {% header "HTTP/1.0 404 Not Found" %}
{% endif %}

{# {% block page %}{% endblock %} #}

{# {% block beforeContent %}
    {% if entry.summary %}
        <div class="container @container">
            {{ processRichHtml( entry.summary ).text }}
        </div>
    {% endif %}
{% endblock %}

{% block afterContent %}
    {% set taggedArticles = craft.entries()
        .section('articles')
        .relatedTo(entry)
        .all() %}

    {% if taggedArticles %}
        <div class="container py-16">
            {% embed 'topBottom' %}
                {% block cell1Body %}
                    <h2>Articles related to {{ entry.title }}</h2>
                {% endblock %}

                {% block cell2Body %}
                    {% embed '_layout/core/micro/gridCols3' %}
                        {% block items %}
                            {% for item in taggedArticles %}
                                {{ include('_cards/item/basic', {
                                    entry: item
                                }, withContext = false ) }}
                            {% endfor %}
                        {% endblock %}
                    {% endembed %}
                {% endblock %}
            {% endembed %}
        </div>
    {% endif %}
{% endblock %} #}