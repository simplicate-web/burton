{% set _base = {
    currentPage: pageInfo.currentPage ??? 1,
    totalPages : pageInfo.totalPages  ??? 0,
    query      : liveFilter.query ??? '',
    topic      : liveFilter.topic ??? null
} %}

{# -- merge `_base` into variables passed into the template  -- #}
{% set settings = ( settings is defined and settings is iterable ) ? settings|merge(_base) : _base %}

{% macro urlWithQueryParams( entryUrl, page, queryParams ) -%}
    {%- set baseUrl  = ( page > 1 ) ? "#{entryUrl}/p#{page}" : entryUrl -%}
    {%- set queryStr = queryParams|url_encode -%}
    {{- queryStr ? "#{baseUrl}?#{queryStr}" : baseUrl -}}
{%- endmacro %}

{% if settings.totalPages > 1 %}
    <nav
        class="cPagination mt-10"
        role="navigation"
        aria-label="Pagination Navigation"
    >
        <ul class="m-0 p-0 list-none flex gap-3 justify-center">
            <li class="w-32">
                <a class="p-3 block border text-center leading-snug text-sm {% if settings.currentPage > 1 %}hover:bg-gray-200{% else %}cursor-not-allowed opacity-40{% endif %}"
                    {% if settings.currentPage > 1 %}
                        href="{{ _self.urlWithQueryParams(settings.entryUrl, settings.currentPage - 1, { q: settings.query, show: settings.topic } ) }}"
                        sprig
                        s-val:page="{{ settings.currentPage - 1 }}"
                        s-trigger="click"
                    {% endif %}
                >&larr; {{"Previous"|t}}</a>
            </li>
            <li class="w-32">
                <a class="p-3 block border text-center leading-snug text-sm {% if settings.currentPage != settings.totalPages %}hover:bg-gray-200{% else %}cursor-not-allowed opacity-40{% endif %}"
                    {% if settings.currentPage != settings.totalPages %}
                        href="{{ _self.urlWithQueryParams(settings.entryUrl, settings.currentPage + 1, { q: settings.query, show: settings.topic } ) }}"
                        sprig
                        s-val:page="{{ settings.currentPage + 1 }}"
                        s-trigger="click"
                    {% endif %}
                >{{"Next"|t}} &rarr;</a>
            </li>
        </ul>

        <p class="text-center text-gray-400 text-xs mt-3">
            Page <strong>{{settings.currentPage}} <span class="scale-90 inline-block">of</span> {{settings.totalPages}}</strong>
        </p>
    </nav>
{% endif %}